(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{230:function(e,t,n){e.exports=n(392)},235:function(e,t,n){},237:function(e,t,n){},308:function(e,t,n){},391:function(e,t,n){},392:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(45),i=n.n(c),s=(n(235),n(236),n(237),n(218)),o=n(23),u=n(16),l=n(20),d=n.n(l),m=n(29),p=n(199),f=n.n(p),b=localStorage.getItem("authToken"),g=f.a.create();b&&(g.defaults.headers.Authorization="Bearer ".concat(b)),g.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&(console.log("Auth error",e.response.data),B.dispatch(k())),Promise.reject(e)}));var h,v,E,j,O=g,w=Object(o.b)("currentUser/fetchCurrentUser",function(){var e=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/api/users/me");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),y=Object(o.c)({name:"currentUser",initialState:{user:null,isLoading:!1},reducers:{signIn:function(e,t){e.user=t.payload.user},logout:function(e){e.user=null,e.isLoading=!1}},extraReducers:(h={},Object(u.a)(h,w.pending,(function(e){e.loading=!0})),Object(u.a)(h,w.fulfilled,(function(e,t){e.user=t.payload})),Object(u.a)(h,w.rejected,(function(){return{user:null,isLoading:!1}})),h)}),x=y.actions,k=x.logout,L=x.signIn,R=y.reducer,N=Object(o.b)("posts/fetchPosts",function(){var e=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),S=Object(o.b)("posts/likePost",function(){var e=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("/".concat(t,"/like"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),C=Object(o.c)({name:"posts",initialState:{posts:[],isLoading:!1},reducers:{},extraReducers:(v={},Object(u.a)(v,N.pending,(function(e){e.isLoading=!0})),Object(u.a)(v,N.fulfilled,(function(e,t){e.posts=t.payload,e.isLoading=!1})),Object(u.a)(v,N.rejected,(function(){return{posts:[],isLoading:!1}})),Object(u.a)(v,S.pending,(function(e){e.isLoading=!0})),Object(u.a)(v,S.fulfilled,(function(e,t){e.isLoading=!1;var n=e.posts.find((function(e){return e._id===t.payload._id})),a=e.posts.indexOf(n);-1!==a&&(e.posts[a].likes=t.payload.likes,e.posts[a].likesNumber=t.payload.likesNumber)})),v)}).reducer,F=Object(o.b)("users/fetchUsers",function(){var e=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),P=Object(o.b)("users/addToFriends",function(){var e=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("/".concat(t,"/add"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),q=Object(o.c)({name:"users",initialState:{users:[],isLoading:!1,resultMessage:null},reducers:{},extraReducers:(E={},Object(u.a)(E,F.pending,(function(e){e.isLoading=!0,e.resultMessage=null})),Object(u.a)(E,F.fulfilled,(function(e,t){e.users=t.payload,e.resultMessage=null,e.isLoading=!1})),Object(u.a)(E,F.rejected,(function(){return{users:[],isLoading:!1}})),Object(u.a)(E,P.fulfilled,(function(e){e.isLoading=!1,e.resultMessage=null})),E)}).reducer,A=Object(o.b)("friends/fetchUserFriend",function(){var e=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),U=Object(o.b)("friends/confirm",function(){var e=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("/".concat(t,"/confirm"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),z=Object(o.b)("friends/reject",function(){var e=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("/".concat(t,"/reject"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{condition:function(){return!!O.defaults.headers.Authorization},dispatchConditionRejection:!1}),I=Object(o.c)({name:"friendsRequest",initialState:{friends:[],isRequestLoading:!1},reducers:{},extraReducers:(j={},Object(u.a)(j,A.pending,(function(e){e.isRequestLoading=!0})),Object(u.a)(j,A.fulfilled,(function(e,t){e.friends=t.payload,e.isRequestLoading=!1})),Object(u.a)(j,A.rejected,(function(){return{friends:[],isLoading:!1}})),Object(u.a)(j,U.pending,(function(e){e.isRequestLoading=!0})),Object(u.a)(j,U.rejected,(function(){return{isLoading:!1}})),Object(u.a)(j,U.fulfilled,(function(e,t){e.isRequestLoading=!1,e.friends=t.payload})),Object(u.a)(j,z.pending,(function(e){e.isRequestLoading=!0})),Object(u.a)(j,z.rejected,(function(){return{isLoading:!1}})),Object(u.a)(j,z.fulfilled,(function(e,t){e.isRequestLoading=!1,e.friends=t.payload})),j)}).reducer,_=function(e){return function(e){return function(t){if(t.type===L.toString()){var n=t.payload.authToken;localStorage.setItem("authToken",n),O.defaults.headers.Authorization="Bearer ".concat(n)}t.type===k.toString()&&(localStorage.clear(),delete O.defaults.headers.Authorization),e(t)}}},T=n(408),M=[].concat(Object(s.a)(Object(o.d)()),[_]),B=Object(o.a)({reducer:{currentUser:R,friends:I,posts:C,users:q,form:T.a},devTools:!0,middleware:M}),J=n(21),W=n(83),$=n(34),H=n(55),V=n(400),Y=n(409),D=n(401),G=n(406),K=n(405),Q=n(403),X=n(402);n(308);var Z=Object(X.a)({form:"signin"})((function(e){var t=e.handleSubmit,n=e.pristine,a=e.submitting,c=e.error;return r.a.createElement("div",{className:"sign-in-form-wrapper"},r.a.createElement(D.a,{className:"sign-in-form",onSubmit:t},r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Email"),r.a.createElement(Q.a,{name:"email",component:"input",type:"text"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Password"),r.a.createElement(Q.a,{name:"password",component:"input",type:"password"})),r.a.createElement(G.a,{disabled:n||a},"Sign In")),c&&r.a.createElement(K.a,{error:!0,attached:"bottom"},c))})),ee=n(141);var te=function(){var e=Object(H.h)(),t=Object(H.g)(),n=Object(J.c)(),c=(e.state||{from:{pathname:"/"}}).from,i=Object(a.useCallback)((function(e){return O.post("/auth",e).then((function(e){return n(L(e.data))})).then((function(){return t.replace(c)})).catch((function(e){throw new ee.a({_error:e.response.data.message})}))}),[]);return r.a.createElement(V.a,{className:"login-page"},r.a.createElement(Z,{onSubmit:i}))};var ne=function(e){return r.a.createElement("div",{className:"home page"},"This is a home page")};function ae(){return r.a.createElement(V.a,{className:"page"},r.a.createElement(Y.a,null,"404 Page not Found"))}var re=n(104),ce=n(37),ie=Object(ce.a)((function(e){return e.currentUser.user}),(function(e){return e}));function se(e){var t=e.children,n=Object(re.a)(e,["children"]),a=!!Object(J.d)(ie);return r.a.createElement(H.b,Object.assign({},n,{render:function(e){var n=e.location;return a?t:r.a.createElement(H.a,{to:{pathname:"/sign-in",state:{from:n}}})}}))}var oe=n(407);var ue=function(e){return r.a.createElement(oe.a,null,r.a.createElement($.b,{to:"/sign-in",className:"item",activeClassName:"active-nav"},"Sign In"),r.a.createElement($.b,{to:"/sign-up",className:"item",activeClassName:"active-nav"},"Sign Up"))};var le=function(){var e=Object(J.c)();return r.a.createElement(oe.a,null,r.a.createElement($.b,{to:"/posts",className:"item",activeClassName:"active-nav"},"Posts"),r.a.createElement($.b,{to:"/users",className:"item",activeClassName:"active-nav"},"Users"),r.a.createElement($.b,{to:"/friends",className:"item",activeClassName:"active-nav"},"Friends"),r.a.createElement(oe.a.Menu,{position:"right"},r.a.createElement(oe.a.Item,{onClick:function(){return e(k())}},"Logout")))};var de=function(){var e=Object(J.c)(),t=Object(J.d)((function(e){return e.posts}));return t.isLoading,t.posts,Object(a.useEffect)((function(){e(N())}),[e]),r.a.createElement("div",null,"Posts page")},me=function(){return r.a.createElement("div",null,"Users page")},pe=(n(391),n(105));var fe=function(e){var t,n=e.input,a=(e.label,e.type),c=e.meta,i=c.touched,s=c.error,o=c.warning,u=Object(re.a)(e,["input","label","type","meta"]);s?t="red":o&&(t="yellow");var l=s||o;return r.a.createElement(D.a.Field,null,r.a.createElement("input",Object.assign({type:a},n,u)),i&&l&&r.a.createElement(pe.a,{basic:!0,color:t,pointing:"above"},l))};var be=function(){var e=Object(m.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/signup/check-user",{params:{email:t.email}});case 2:if(!e.sent.data.isUserExist){e.next=5;break}throw{email:"This email is already taken"};case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=Object(X.a)({form:"signup",validate:function(e){var t={};return e.email?/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.email)||(t.email="Invalid email address"):t.email="Required!",e.password||(t.password="Required"),e.password!==e.repeatPassword&&(t.repeatPassword="Password Must be equal"),e.first_name||(t.first_name="Required"),e.last_name||(t.last_name="Required"),e.age?e.age<18&&(t.age="Sorry, you must be at least 18 years old"):t.age="Required",t},warn:function(e){var t,n={};return e.age<19&&(n.age="Hmm, you seem a bit young..."),(null===e||void 0===e?void 0:null===(t=e.password)||void 0===t?void 0:t.length)<6&&(n.password="Password is too weak"),n},asyncValidate:be,asyncBlurFields:["email"]})((function(e){var t=e.handleSubmit,n=e.pristine,a=e.submitting,c=e.error,i=e.invalid;return r.a.createElement("div",{className:"sign-up-form-wrapper"},r.a.createElement(D.a,{className:"sign-up-form",onSubmit:t},r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Email"),r.a.createElement(Q.a,{name:"email",component:fe,type:"text"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Password"),r.a.createElement(Q.a,{name:"password",component:fe,type:"password"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Repeat Password"),r.a.createElement(Q.a,{name:"repeatPassword",component:fe,type:"password"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"First Name"),r.a.createElement(Q.a,{name:"first_name",component:fe,type:"text"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Last Name"),r.a.createElement(Q.a,{name:"last_name",component:fe,type:"text"})),r.a.createElement(D.a.Field,null,r.a.createElement("label",null,"Age"),r.a.createElement(Q.a,{name:"age",component:fe,type:"number"})),r.a.createElement(G.a,{disabled:i||n||a},"Sign Up")),c&&r.a.createElement(K.a,{error:!0,attached:"bottom"},c))}));var he=function(){var e=Object(a.useState)(!1),t=Object(W.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),s=Object(W.a)(i,2),o=s[0],u=s[1];return r.a.createElement(V.a,{className:"sign-up-page"},!n&&r.a.createElement(ge,{onSubmit:function(e){O.post("/signup",e).then((function(){c(!0),u(e.email)}))}}),n&&r.a.createElement(K.a,{success:!0,header:"Your user registration was successful",content:r.a.createElement("div",null,"Please confirm your email address ",r.a.createElement("strong",null,o))}))};var ve=function(){return r.a.createElement("div",null,r.a.createElement("div",null,"Friends page"))};var Ee=function(){var e=Object(J.d)(ie),t=Object(J.c)(),n=Object(a.useState)(!1),c=Object(W.a)(n,2),i=c[0],s=c[1];return Object(a.useEffect)((function(){t(w()).then((function(){return s(!0)})).catch((function(){return s(!0)}))}),[t]),i?r.a.createElement(V.a,{className:"social-app"},r.a.createElement($.a,null,r.a.createElement(Y.a,null,r.a.createElement($.b,{to:"/",activeClassName:"active-nav"},"Social app")),!e&&r.a.createElement(ue,null),e&&r.a.createElement(le,null),r.a.createElement(H.d,null,r.a.createElement(H.b,{path:"/",exact:!0},r.a.createElement(ne,null)),r.a.createElement(H.b,{path:"/sign-in",exact:!0},r.a.createElement(te,null)),r.a.createElement(H.b,{path:"/sign-up",exact:!0},r.a.createElement(he,null)),r.a.createElement(se,{path:"/posts",exact:!0},r.a.createElement(de,null)),r.a.createElement(se,{path:"/users",exact:!0},r.a.createElement(me,null)),r.a.createElement(se,{path:"/friends",exact:!0},r.a.createElement(ve,null)),r.a.createElement(H.b,{path:"*",component:ae})))):null};function je(){return r.a.createElement(J.a,{store:B},r.a.createElement(Ee,null))}var Oe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(je,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[230,1,2]]]);
//# sourceMappingURL=main.9a3941ae.chunk.js.map